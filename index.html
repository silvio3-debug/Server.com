<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>My Website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ----- Base ----- */
    :root { --bg:#ffffff; --text:#111; --brand:#333; --brand-2:#222; --hover:#444; --overlay:rgba(0,0,0,.4); }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Arial, sans-serif; color:var(--text); background:var(--bg); }
    main { padding: 20px; text-align: center; min-height: 60vh; }

    /* ----- Top bar ----- */
    .topbar {
      display:flex; align-items:center; gap:12px;
      background: var(--brand); color:#fff; padding:12px 16px;
    }
    .menu-icon { font-size:26px; cursor:pointer; user-select:none; }
    .brand { font-size:18px; font-weight:700; margin:0; }

    /* ----- Side menu ----- */
    .overlay {
      position:fixed; inset:0; background:var(--overlay); display:none; z-index:999;
    }
    .side-menu {
      position:fixed; top:0; left:0; height:100vh; width:0;
      background:var(--brand-2); color:#fff; overflow-x:hidden;
      transition: width .25s ease; padding-top:60px; z-index:1000;
    }
    .side-menu.open { width:270px; }
    .overlay.show { display:block; }
    .side-menu .close-btn {
      position:absolute; top:14px; right:18px; font-size:28px; cursor:pointer;
    }
    .side-menu a {
      display:block; padding:12px 20px; color:#fff; text-decoration:none; font-size:18px;
    }
    .side-menu a:hover { background:var(--hover); }

    /* ----- Chat widget ----- */
    #chat-toggle {
      position:fixed; bottom:20px; right:20px; z-index:1100;
      background:var(--brand); color:#fff; border:none; border-radius:50%;
      width:54px; height:54px; font-size:24px; cursor:pointer;
      box-shadow:0 4px 14px rgba(0,0,0,.2);
    }
    #chat-container {
      position:fixed; bottom:84px; right:20px; z-index:1100;
      width:320px; max-width:calc(100vw - 24px);
      background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.25);
      display:none; flex-direction:column; overflow:hidden;
    }
    #chat-header {
      background:var(--brand); color:#fff; padding:10px 12px; font-weight:700; display:flex; align-items:center; justify-content:space-between;
    }
    #chat-close { cursor:pointer; font-size:20px; }
    #chat-messages {
      height:260px; overflow-y:auto; padding:10px; font-size:14px;
      background:#fafafa;
    }
    .msg { margin:8px 0; text-align:left; line-height:1.35; }
    .msg.you { text-align:right; }
    .bubble {
      display:inline-block; padding:8px 10px; border-radius:10px; max-width:90%;
    }
    .you .bubble { background:#e6f2ff; }
    .ai .bubble { background:#eee; }
    .system .bubble { background:#ffe9c4; }
    #chat-input { display:flex; border-top:1px solid #ddd; }
    #chat-input input {
      flex:1; padding:12px; border:none; outline:none; font-size:14px; background:#fff;
    }
    #chat-input button {
      border:none; background:var(--brand); color:#fff; padding:0 16px; cursor:pointer; font-weight:600;
    }
    .typing { font-style:italic; opacity:.75; }
  </style>
</head>
<body>

  <!-- Overlay -->
  <div id="overlay" class="overlay" onclick="closeMenu()"></div>

  <!-- Side menu -->
  <nav id="sideMenu" class="side-menu" aria-label="Main">
    <span class="close-btn" onclick="closeMenu()">Ã—</span>
    <a href="#">Home</a>
    <a href="#">Category</a>
    <a href="#">Trending</a>
  </nav>

  <!-- Top bar -->
  <header class="topbar">
    <span class="menu-icon" onclick="openMenu()">â˜°</span>
    <h1 class="brand">My Website</h1>
  </header>

  <!-- Main content -->
  <main>
    <h2>Welcome</h2>
    <p>Click the â˜° icon to open the menu â€” and use the ðŸ’¬ button to chat with AI.</p>
  </main>

  <!-- Chat toggle button -->
  <button id="chat-toggle" aria-label="Open chat">ðŸ’¬</button>

  <!-- Chat container -->
  <section id="chat-container" aria-live="polite">
    <div id="chat-header">
      <span>AI Chatbot</span>
      <span id="chat-close" title="Close">Ã—</span>
    </div>
    <div id="chat-messages"></div>
    <div id="chat-input">
      <input type="text" id="message-input" placeholder="Type a message..." />
      <button id="send-btn">Send</button>
    </div>
  </section>

  <script>
    /* ====== MENU ====== */
    const sideMenu = document.getElementById('sideMenu');
    const overlay = document.getElementById('overlay');

    function openMenu() {
      sideMenu.classList.add('open');
      overlay.classList.add('show');
    }
    function closeMenu() {
      sideMenu.classList.remove('open');
      overlay.classList.remove('show');
    }

    /* ====== CHAT UI ====== */
    const BACKEND_URL = "https://your-ai-backend.onrender.com"; // <-- replace after deploying backend

    const chatToggle = document.getElementById('chat-toggle');
    const chatContainer = document.getElementById('chat-container');
    const chatClose = document.getElementById('chat-close');
    const chatMessages = document.getElementById('chat-messages');
    const sendBtn = document.getElementById('send-btn');
    const messageInput = document.getElementById('message-input');

    chatToggle.onclick = () => {
      chatContainer.style.display = (chatContainer.style.display === 'flex') ? 'none' : 'flex';
      chatContainer.style.display = chatContainer.style.display || 'flex';
      if (chatContainer.style.display === 'flex' && chatMessages.children.length === 0) {
        addSystem("Hi! Ask me anything.");
      }
    };
    chatClose.onclick = () => { chatContainer.style.display = 'none'; };

    sendBtn.onclick = sendMessage;
    messageInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    function addMessage(role, text) {
      const wrap = document.createElement('div');
      wrap.className = `msg ${role}`;
      const bub = document.createElement('div');
      bub.className = 'bubble';
      bub.textContent = text;
      wrap.appendChild(bub);
      chatMessages.appendChild(wrap);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    function addSystem(text) { const n = document.createElement('div'); n.className='msg system'; const b=document.createElement('div'); b.className='bubble'; b.textContent=text; n.appendChild(b); chatMessages.appendChild(n); chatMessages.scrollTop=chatMessages.scrollHeight; }
    function addTyping() { const n=document.createElement('div'); n.className='msg ai typing'; const b=document.createElement('div'); b.className='bubble'; b.textContent='AI is typingâ€¦'; n.appendChild(b); chatMessages.appendChild(n); chatMessages.scrollTop=chatMessages.scrollHeight; return n; }
    function replaceTyping(node, text) { node.classList.remove('typing'); node.querySelector('.bubble').textContent = text; }

    async function sendMessage() {
      const message = messageInput.value.trim();
      if (!message) return;
      addMessage('you', message);
      messageInput.value = '';

      const typingNode = addTyping();

      try {
        if (!BACKEND_URL || BACKEND_URL.includes('your-ai-backend')) {
          // Friendly hint if they didn't set the backend yet
          await new Promise(r => setTimeout(r, 400));
          replaceTyping(typingNode, "Backend URL not set yet. Replace BACKEND_URL in index.html with your deployed server URL.");
          return;
        }

        const res = await fetch(`${BACKEND_URL}/chat`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message })
        });

        if (!res.ok) {
          const errText = await res.text().catch(()=>res.statusText);
          replaceTyping(typingNode, `Error: ${res.status} ${errText}`);
          return;
        }

        const data = await res.json();
        replaceTyping(typingNode, data.reply ?? "(No reply)");
      } catch (e) {
        replaceTyping(typingNode, "Network error. Please try again.");
      }
    }
  </script>
</body>
</html>
